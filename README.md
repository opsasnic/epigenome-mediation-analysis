The following code corresponds to our manuscript entitled: "Epigenome-Wide Mediation Analysis of the Relationship between Psychosocial Stress and Cardiometabolic Risk Factors in the Health and Retirement Study (HRS)". 
This document will detail each of the R files that have been included: 
1) Demographic Tables - This code calcluates the sample demographic characteristics (Table 1). It also characterizes the difference in demographics between those included vs. excluded in the final analysis from the entire DNA methylation sample (n=4018) (Table S1). 
2) Total effects_Stress CVD risk factors - This code calculates the total effects of psychosocial stress on each of the 10 cardiometabolic risk factors in Model 1 and Model 2
3) "Outcome"_exposure mediator - There are 4 separate files where "Outcome" is replaced with BMI, WC, HDL-C and CRP. This code runs the first model needed for mediation analysis, performing epigenome wide associations between stress and DNA methylation. We have four different sets of code because each outcome has a slightly different sample size, therefore associations between the exposure and mediators will be slighty different for each outcome.  
4) "Outcome"_exposure mediator_smoking - There are 4 separate files "Outcome" is replaced with BMI, WC, HDL-C and CRP. This code runs the first model needed for the sensitivity mediation analysis (adjusting for smoking), performing epigenome wide associations between stress and DNA methylation. We have four different sets of code because each outcome has a slightly different sample size, therefore associations between the exposure and mediators will be slighty different for each outcome.  
5) "Outcome"_mediator outcome - There are 4 separate files where "Outcome" is replaced with BMI, WC, HDL-C and CRP. This code runs the second model needed for mediation analysis, performing epigenome wide associations between DNA metyhlation and the appropriate outcome. 
6) "Outcome"_mediator outcome_smoking - There are 4 separate files where "Outcome" is replaced with BMI, WC, HDL-C and CRP. This code runs the second model needed for the sensitivity mediation analysis (adjusting for smoking), performing epigenome wide associations between DNA metyhlation and the appropriate outcome.
7) "Outcome"_mediation and downstream analysis - There are 4 separate files where "Outcome" is replaced with BMI, WC, HDL-C and CRP. This code conducts the HDMT mediation analysis and saves the corresponding CpG mediators for the appropriate outcome. It then annotates those results to construct QQ and Manhattan plots. Code in this file also matches the identified CpG mediators to their genomic locations and performs enrichment analysis. Finally, GO and KEGG pathway analysis is conducted using the eQTM data from Keshawarz et al. (2023).
8) All outcomes_mediation sensitivity analysis - This code conducts the HDMT sensitivity mediation analysis for all 4 outcomes (BMI, WC, HDL-C, CRP) when further adjusting for smoking status. It then extracts the CpGs that were identified as mediators in the primary analysis to compare the effect estimates. 
9) All outcomes_PCA - This code conducts principal component (PC) analysis on each set of CpG mediators for all 4 outcomes (BMI, WC, HDL-C, CRP). The CpG mediators for each outcome are reduced to their top 10 PCs. Then, those PCs are tested as mediators of the stress-cardiometabolic risk outcomes. 
10) All outcomes_HIMA - This code conducts penalized linear regression models (HIMA) for each set of CpG mediators for all 4 outcomes (BMI, WC, HDL-C, CRP). For each outcome, this code fits multivariable mediation model, assigning all CpGs identified in HDMT as the mediators.
